language: cpp
os:
  - linux
  - osx
compiler:
  - gcc
  - clang
env:
  - CTEST_MODEL=Experimental
  - CTEST_MODEL=Nightly
before_install:
  - if [ $TRAVIS_OS_NAME == linux ]; then sudo apt-get update; fi
  - if [ $TRAVIS_OS_NAME == osx ]; then brew update; fi
install:
  - if [ $TRAVIS_OS_NAME == linux ]; then sudo pip install gcovr; fi
  - if [ $TRAVIS_OS_NAME == linux ]; then sudo apt-get install valgrind; fi
  - if [ $TRAVIS_OS_NAME == linux ]; then wget -qO- http://www.cmake.org/files/v3.1/cmake-3.1.0-Linux-x86_64.tar.gz | tar xvz; fi
  - if [ $TRAVIS_OS_NAME == osx ]; then brew install cmake; fi
  - if [ $TRAVIS_OS_NAME == osx ]; then brew install valgrind; fi
script:
  - if [ $TRAVIS_OS_NAME == linux ]; then ./cmake-3.1.0-Linux-x86_64/bin/ctest -VV -S ./template/template_test.cmake -DCTEST_TARGET_SYSTEM=Linux -DCTEST_MODEL=$CTEST_MODEL -DCTEST_EMPTY_BINARY_DIRECTORY=FALSE; fi
  - if [ $TRAVIS_OS_NAME == osx ]; then ctest -VV -S ./template/template_test.cmake -DCTEST_TARGET_SYSTEM=MacOS -DCTEST_MODEL=$CTEST_MODEL; fi
notifications:
  email: false
